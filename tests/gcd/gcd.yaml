defaults:
  NumericalString:
    !Template
    charmap: 01234567890abcdefghijklmnopqrstuvwxyz
  FramedBase:
    !Template
    border_size: 1
    border_margin: 6
    label: 
    label_size: 8
    label_font: Mono
  LineGrid:
    !Template
    dir: row
  Text:
    !Template
    text: !NumericalString {radix: 10}
    text_size: 14
    text_font: Mono
  MemoryArray:
    !Template
    dir: row
    offset: 0
    offset_anchor: 0
    rows: 1
    cols: 1
    
lib:
  defNumericalString:
    !Template
    charmap: 01234567890abcdefghijklmnopqrstuvwxyz
  defFramedBase:
    !Template
    path: ""
    border_size: 1
    border_margin: 6
    label: ""
    label_size: 8
    label_font: Mono
  defLineGrid:
    !Template
    template: defFramedBase
    dir: row
  defTextBox:
    !Template
    template: defFramedBase
    text: ""
    text_color: "white"
    text_size: 14
    text_font: Mono
  defMemoryArray:
    !Template
    template: defFramedBase
    step: row
    offset: 0
    offset_anchor: 0
    rows: 1
    cols: 1

  text_binary:
    !Template
    template: defTextBox
    text: !NumericalString {charmap: 01, prefix: 0b, radix: 2}
  text_decimal:
    !Template
    template: defTextBox
    text: !NumericalString {charmap: 01234567890, prefix: "", radix: 10}
  text_hexadecimal:
    !Template
    template: defTextBox
    text: !NumericalString {charmap: 01234567890abcdef, prefix: 0x, radix: 16}
  text_bool:
    !DictTemplate
    template: defTextBox
    mapping:
      0: {text: "false", text_color: red}
      1: {text: "true", text_color: green}
      default: {text: "true*", text_color: green}
    
  gcd_state_map:
    !DictTemplate
    template: defTextBox
    mapping:
      0: {text: idle, text_color: pink}
      1: {text: calc, text_color: yellow}
      2: {text: done, text_color: green}
      
  gcd_state:
    !LineGrid
    template: defLineGrid
    label: state
    dir: col
    cells:
    - !TextBox {path: .state, template: gcd_state_map}
    - !TextBox {path: .latch_A, template: text_decimal}
    - !TextBox {path: .latch_B, template: text_decimal}
  gcd_io_in:
    !LineGrid
    template: defLineGrid
    label: io (in)
    dir: col
    cells:
    - !TextBox {path: _operands_bits_A, template: text_decimal}
    - !TextBox {path: _operands_bits_B, template: text_decimal}
    - !TextBox {path: _operands_val, template: text_bool}
    - !TextBox {path: _operands_rdy, template: text_bool}
  gcd_io_out:
    !LineGrid
    template: defLineGrid
    label: io (out)
    dir: col
    cells:
    - !TextBox {path: _result_bits_data, template: text_decimal}
    - !TextBox {path: _result_val, template: text_bool}
    - !TextBox {path: _result_rdy, template: text_bool}

  gcd:
    !LineGrid
    template: defLineGrid
    dir: row
    cells:
    - !Ref {ref: gcd_io_in, path: .io}
    - !Ref {ref: gcd_state}
    - !Ref {ref: gcd_io_out, path: .io}

display:
- !Ref {ref: gcd, path: GCD}
